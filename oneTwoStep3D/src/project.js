System.register("chunks:///PlayerController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t){"use strict";var e,i,o,s,n,u,r,p,c,a,l,m,h,_,y,g,d,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inherits,o=t.createClass,s=t.classCallCheck,n=t.possibleConstructorReturn,u=t.getPrototypeOf,r=t.initializerDefineProperty,p=t.assertThisInitialized},function(t){c=t.cclegacy,a=t._decorator,l=t.AnimationComponent,m=t.SkeletalAnimationComponent,h=t.v3,_=t.systemEvent,y=t.SystemEvent,g=t.AudioSourceComponent,d=t.Vec3,v=t.Component}],execute:function(){var P,f,S,b,j,C,T;c._RF.push({},"1ca93+K2ldFSbHczoAgxPgg","PlayerController",void 0);var A=a.ccclass,J=a.property;t("PlayerController",(P=A("PlayerController"),f=J({type:l}),S=J({type:m}),P((C=e((j=function(t){function e(){var t,i;s(this,e);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return i=n(this,(t=u(e)).call.apply(t,[this].concat(c))),r(i,"bodyAnim",C,p(i)),r(i,"cocosAnimation",T,p(i)),i._startJump=!1,i._jumpStep=0,i._curJumpTime=0,i._jumpTime=.3,i._curJumpSpeed=0,i._curPos=h(),i._deltaPos=h(0,0,0),i._targetPos=h(),i._isMoving=!1,i.stepCount=0,i.stopTime=0,i.gameOver=!1,i.begin=!1,i}return i(e,t),o(e,[{key:"start",value:function(){}},{key:"setInputActive",value:function(t){t?(this.begin=!0,_.on(y.EventType.MOUSE_UP,this.onMouseUp,this)):_.off(y.EventType.MOUSE_UP,this.onMouseUp,this)}},{key:"onMouseUp",value:function(t){this.begin&&(console.log("开始播放音效"),this.node.getComponent(g).play()),0===t.getButton()?this.jumpByStep(1):2===t.getButton()&&(this.bodyAnim.play("twoStep"),this.jumpByStep(2))}},{key:"jumpByStep",value:function(t){this._isMoving||(this._startJump=!0,this._jumpStep=t,this._curJumpTime=0,this._curJumpSpeed=this._jumpStep/this._jumpTime,this.node.getPosition(this._curPos),d.add(this._targetPos,this._curPos,h(this._jumpStep,0,0)),this.stepCount+=t,this._isMoving=!0,this.cocosAnimation.getState("cocos_anim_jump").speed=5,this.cocosAnimation.play("cocos_anim_jump"))}},{key:"onOnceJumpEnd",value:function(){this._isMoving=!1,this.node.emit("jumpEnd",this.stepCount),this.cocosAnimation.play("cocos_anim_idle"),this.stopTime=0}},{key:"update",value:function(t){!this._isMoving&&this.begin&&(this.stopTime+=t,this.stopTime>1&&(this.gameOver=!0,this.begin=!1,this.stopTime=0)),this._startJump&&(console.log("jump"),this._curJumpTime+=t,this._curJumpTime>this._jumpTime?(this.node.setPosition(this._targetPos),this._startJump=!1,this.onOnceJumpEnd()):(this._deltaPos.x=this._curJumpSpeed*t,d.add(this._curPos,this._curPos,this._deltaPos),this.node.setPosition(this._curPos)))}}]),e}(v)).prototype,"bodyAnim",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(j.prototype,"cocosAnimation",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=j))||b));c._RF.pop()}}}));

System.register("chunks:///Managers/GameManager.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../PlayerController.js"],(function(e){"use strict";var t,r,i,o,a,n,s,l,h,u,c,p,d,g,y,_,f,N,v,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,i=e.createClass,o=e.classCallCheck,a=e.possibleConstructorReturn,n=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){h=e.cclegacy,u=e._decorator,c=e.Prefab,p=e.CCInteger,d=e.LabelComponent,g=e.Node,y=e.v3,_=e.NodePool,f=e.instantiate,N=e.AudioSourceComponent,v=e.Component},function(e){m=e.PlayerController}],execute:function(){var b,C,S,T,G,P,I,O,B,k,E,M,L,w,A,z,D;h._RF.push({},"b6e41ILvb1FpK28pbgRe4tT","GameManager",void 0);var j,R,x=u.ccclass,Y=u.property;!function(e){e[e.BT_NONE=0]="BT_NONE",e[e.BT_STONE=1]="BT_STONE"}(j||(j={})),function(e){e[e.GS_INIT=0]="GS_INIT",e[e.GS_PLAYING=1]="GS_PLAYING",e[e.GS_END=2]="GS_END"}(R||(R={}));e("GameManager",(b=x("GameManager"),C=Y({type:c}),S=Y({type:p}),T=Y({type:m}),G=Y({type:d}),P=Y({type:g}),I=Y({type:c}),O=Y({type:g}),b((E=t((k=function(e){function t(){var e,r;o(this,t);for(var i=arguments.length,h=new Array(i),u=0;u<i;u++)h[u]=arguments[u];return r=a(this,(e=n(t)).call.apply(e,[this].concat(h))),s(r,"cubePrefab",E,l(r)),s(r,"roadLength",M,l(r)),s(r,"playerCtrl",L,l(r)),s(r,"scoreLabel",w,l(r)),s(r,"canvasNode",A,l(r)),s(r,"overMenuPrefab",z,l(r)),s(r,"startMenu",D,l(r)),r._road=[],r._curState=R.GS_INIT,r.poolLength=15,r.pool=null,r.curPos=y(),r.steps=0,r.totalTime=0,r.gameOverNode=null,r}return r(t,e),i(t,[{key:"start",value:function(){this.pool=new _,this.createBlockPool(),this.curState=R.GS_INIT,this.playerCtrl.node.on("jumpEnd",this.playerJumpEnd,this)}},{key:"playerJumpEnd",value:function(e){if(console.log("data is ",e),this.steps=e,this.scoreLabel.node.getComponent(d).string=e.toString(),e>=5){for(var t=this.playerCtrl.node.getPosition().x,r=0,i=[],o=0;o<this.node.children.length;o++)this.node.children[o].getPosition().x<t-4&&(r++,i.push(this.node.children[o]));for(var a=0;a<r;a++)this._road[this._road.length-1]===j.BT_NONE?this._road.push(j.BT_STONE):this._road.push(Math.floor(2*Math.random()));console.log("road is ",this._road);for(var n=0;n<i.length;n++)1===this._road[n+this._road.length-r]&&i[n].setPosition(n+this._road.length-r,-1.5,0)}}},{key:"init",value:function(){this.startMenu.active=!0,this.playerCtrl.gameOver=!1,this.generateRoad(),this.playerCtrl.setInputActive(!1),this.playerCtrl.node.setPosition(y(1,0,0)),this.totalTime=0,this.steps=0,this.scoreLabel.node.getComponent(d).string="0",this.playerCtrl.stepCount=0,this.gameOverNode&&this.gameOverNode.destroy()}},{key:"restartGame",value:function(e){for(this.playerCtrl.begin=!1;this.node.children.length>0;)this.pool.put(this.node.children[this.node.children.length-1]);this.curState=R.GS_INIT,this._curState=R.GS_INIT}},{key:"btnEvent",value:function(e,t){if(this._curState!==R.GS_END)switch(t){case"play":this.curState=R.GS_PLAYING;break;case"one":this.playerCtrl.jumpByStep(1);break;case"two":this.playerCtrl.jumpByStep(2)}}},{key:"generateRoad",value:function(){this.node.removeAllChildren(),this._road=[],this._road.push(j.BT_NONE);for(var e=1;e<this.poolLength;e++)this._road[e-1]===j.BT_NONE?this._road.push(j.BT_STONE):this._road.push(Math.floor(2*Math.random()));for(var t=0;t<this._road.length;t++){var r=this.spawnBlockByType(this._road[t]);r&&(this.node.addChild(r),r.setPosition(t,-1.5,0))}}},{key:"spawnBlockByType",value:function(e){var t=null;switch(e){case j.BT_STONE:t=this.pool.get();break;case j.BT_NONE:}return t}},{key:"createBlockPool",value:function(){for(var e=0;e<this.poolLength;e++){var t=f(this.cubePrefab);this.pool.put(t)}}},{key:"update",value:function(e){if(this._curState===R.GS_PLAYING&&(this.totalTime+=e),!this.playerCtrl._isMoving){var t=this.playerCtrl.node.getPosition().x;(this._road[t]===j.BT_NONE||this.playerCtrl.gameOver)&&(this.playerCtrl.stopTime=0,this._curState!==R.GS_END&&(this.curState=R.GS_END),this.playerCtrl.gameOver&&console.log("静止时间超过1秒了"))}}},{key:"curState",set:function(e){switch(e){case R.GS_INIT:this.init();break;case R.GS_PLAYING:this.startMenu.active=!1;var t=this;setTimeout((function(){t.playerCtrl.setInputActive(!0)}),.1);break;case R.GS_END:this.playerCtrl.setInputActive(!1),this.gameOverNode=f(this.overMenuPrefab),this.gameOverNode.getChildByName("stepsNum").getComponent(d).string=this.steps.toString(),this.gameOverNode.getChildByName("timeNum").getComponent(d).string=this.totalTime.toFixed(2)+"s",this.canvasNode.addChild(this.gameOverNode),this.gameOverNode.setPosition(y(0,0,0)),this.gameOverNode.getChildByName("restart").on("click",this.restartGame,this),this.node.getComponent(N).play()}this._curState=e}}]),t}(v)).prototype,"cubePrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(k.prototype,"roadLength",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),L=t(k.prototype,"playerCtrl",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(k.prototype,"scoreLabel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(k.prototype,"canvasNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(k.prototype,"overMenuPrefab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(k.prototype,"startMenu",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=k))||B));h._RF.pop()}}}));

System.register("chunks:///_virtual/_rollupPluginBabelHelpers.js",[],(function(e){"use strict";return{execute:function(){function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(t){return(r=e("getPrototypeOf",Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)}))(t)}function i(t,r){return(i=e("setPrototypeOf",Object.setPrototypeOf||function(e,t){return e.__proto__=t,e}))(t,r)}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e({applyDecoratedDescriptor:function(e,t,r,i,n){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce((function(r,i){return i(e,t,r)||r}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null);return o},assertThisInitialized:n,classCallCheck:function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass:function(e,r,i){r&&t(e.prototype,r);i&&t(e,i);return e},getPrototypeOf:r,inherits:function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)},initializerDefineProperty:function(e,t,r,i){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})},possibleConstructorReturn:function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;return n(e)},setPrototypeOf:i})}}}));

(function () {
    var aliasChunk = function(chunkId, moduleId) {
        System.register(moduleId, [chunkId], function (_export, _context) {
            var _m;
            return {
                setters: [function(m) {
                    _m = m;
                }],
                execute: function () {
                    _export(_m);
                }
            };
        });
    };
	aliasChunk('chunks:///PlayerController.js', 'project:///assets/Scripts/PlayerController.js');
	aliasChunk('chunks:///Managers/GameManager.js', 'project:///assets/Scripts/Managers/GameManager.js');
})();
